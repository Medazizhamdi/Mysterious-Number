<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Trouve le Nombre Myst√®re !</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding-top: 50px;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
    }
    #message, #tentativesRestantes, #bestScore {
      margin-top: 20px;
      font-weight: bold;
    }
    #rejouerBtn {
      display: none;
    }
  </style>
</head>
<body>

  <h1>Trouve le Nombre Myst√®re !</h1>
  <div id="tentativesRestantes">Il te reste 6 tentatives</div>
  <div id="bestScore">Meilleur score : -</div>

  <input type="number" id="guessInput" placeholder="Entre un nombre" />
  <button onclick="verifier()" id="verifierBtn">V√©rifier</button>
  <button onclick="rejouer()" id="rejouerBtn">Rejouer</button>

  <div id="message"></div>

  <script>
    let nombreMystere;
    let essais = 0;
    const maxEssais = 6;

    // Charger le nombre myst√®re via AJAX
    function chargerNombre() {
      const xhr = new XMLHttpRequest();
      xhr.open("GET", "nombre.json", true);
      xhr.onload = function () {
        if (xhr.status === 200) {
          const data = JSON.parse(xhr.responseText);
          nombreMystere = data.secret;
        } else {
          document.getElementById("message").textContent = "Erreur lors du chargement du nombre.";
        }
      };
      xhr.send();
    }

    chargerNombre(); // Charger d√®s le d√©but

    function verifier() {
      const entree = document.getElementById("guessInput").value;
      const nombre = parseInt(entree);

      if (isNaN(nombre)) {
        document.getElementById("message").textContent = "Veuillez entrer un nombre valide.";
        return;
      }

      essais++;
      const tentativesRestantes = maxEssais - essais;
      let message = "";

      if (nombre === nombreMystere) {
        message = "üéâ Bravo ! Tu as trouv√© en " + essais + " essais.";
        document.getElementById("verifierBtn").disabled = true;
        document.getElementById("rejouerBtn").style.display = "inline-block";

        // Mettre √† jour le meilleur score
        const best = localStorage.getItem("bestScore");
        if (!best || essais < parseInt(best)) {
          localStorage.setItem("bestScore", essais);
          document.getElementById("bestScore").textContent = "Meilleur score : " + essais + " essais";
        }
      } else {
        const ecart = Math.abs(nombreMystere - nombre);
        if (ecart <= 3) {
          message = "üî• Tu es TR√àS proche, ";
        } else if (ecart <= 10) {
          message = "‚ú® Tu es proche, ";
        }

        if (nombre < nombreMystere) {
          message += "le nombre est plus grand.";
        } else {
          message += "le nombre est plus petit.";
        }

        if (tentativesRestantes === 0) {
          message += " ‚ùå Tu as utilis√© tes 6 essais. Le nombre √©tait " + nombreMystere + ".";
          document.getElementById("verifierBtn").disabled = true;
          document.getElementById("rejouerBtn").style.display = "inline-block";
        }
      }

      document.getElementById("message").textContent = message;
      document.getElementById("tentativesRestantes").textContent =
        tentativesRestantes > 0
          ? "Il te reste " + tentativesRestantes + " tentative" + (tentativesRestantes > 1 ? "s" : "")
          : "Aucune tentative restante.";
    }

    function rejouer() {
      essais = 0;
      document.getElementById("guessInput").value = "";
      document.getElementById("message").textContent = "";
      document.getElementById("verifierBtn").disabled = false;
      document.getElementById("rejouerBtn").style.display = "none";
      document.getElementById("tentativesRestantes").textContent = "Il te reste 6 tentatives";
      chargerNombre();
    }

    // Afficher le meilleur score d√®s le d√©but
    window.onload = function () {
      const best = localStorage.getItem("bestScore");
      if (best) {
        document.getElementById("bestScore").textContent = "Meilleur score : " + best + " essais";
      }
    };
  </script>

</body>
</html>
